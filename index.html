<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ego Finder</title>
    <!-- Chart.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg-color: #0a0a0a;
            --text-color: #e0e0e0;
            --accent-color: #00ffcc; /* Neon Cyan */
            --secondary-color: #333;
            --panel-bg: #111;
        }

        body {
            font-family: 'Courier New', Courier, monospace;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            user-select: none;
        }

        .container {
            width: 90%;
            max-width: 700px;
            text-align: center;
            height: auto;
            max-height: 95vh;
            overflow-y: auto;
            padding: 10px;
        }

        /* LANDING PAGE */
        #landing-page {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            width: 100%;
            position: absolute;
            top: 0;
            left: 0;
            background: var(--bg-color);
            z-index: 10;
        }

        .init-btn {
            background: transparent;
            border: 2px solid var(--accent-color);
            color: var(--accent-color);
            padding: 20px 50px;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: uppercase;
            letter-spacing: 3px;
            border-radius: 4px;
        }

        .init-btn:hover {
            background: var(--accent-color);
            color: var(--bg-color);
            box-shadow: 0 0 20px var(--accent-color);
        }

        /* QUIZ SECTION */
        #quiz-section {
            display: none;
            padding: 30px;
            background: var(--panel-bg);
            border: 1px solid var(--secondary-color);
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: var(--secondary-color);
            margin-bottom: 30px;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: var(--accent-color);
            width: 0%;
            transition: width 0.3s ease;
            box-shadow: 0 0 10px var(--accent-color);
        }

        .question-text {
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 50px;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* SLIDER LAYOUT */
        .slider-wrapper {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 40px 0;
            gap: 20px;
        }

        .slider-label {
            flex: 1;
            font-size: 0.8rem;
            color: #888;
            text-transform: uppercase;
            line-height: 1.2;
            font-weight: bold;
        }
        
        .slider-label.left { text-align: right; }
        .slider-label.right { text-align: left; }

        .range-container {
            flex: 4;
            position: relative;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ticks-overlay {
            position: absolute;
            top: 50%;
            left: 0;
            width: 100%;
            height: 10px;
            transform: translateY(-50%);
            display: flex;
            justify-content: space-between;
            pointer-events: none;
            z-index: 0;
            padding: 0 10px;
            box-sizing: border-box;
        }

        .tick {
            width: 2px;
            height: 10px;
            background: #444;
        }

        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            height: 4px;
            background: #333;
            outline: none;
            border-radius: 2px;
            z-index: 1;
            margin: 0;
            cursor: pointer;
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: var(--accent-color);
            cursor: pointer;
            box-shadow: 0 0 10px var(--accent-color);
            border: 2px solid #fff;
        }

        input[type=range]::-moz-range-thumb {
            width: 22px;
            height: 22px;
            border: none;
            border-radius: 50%;
            background: var(--accent-color);
            cursor: pointer;
            box-shadow: 0 0 10px var(--accent-color);
            border: 2px solid #fff;
        }

        input[type=range]:focus {
            outline: none;
        }

        .next-btn {
            background: var(--accent-color);
            color: #000;
            border: none;
            padding: 14px 40px;
            cursor: pointer;
            font-family: inherit;
            text-transform: uppercase;
            font-size: 1rem;
            letter-spacing: 2px;
            font-weight: bold;
            margin-top: 20px;
            border-radius: 4px;
            box-shadow: 0 0 10px rgba(0, 255, 204, 0.3);
            transition: transform 0.1s ease;
            outline: none;
        }

        .next-btn:hover {
            box-shadow: 0 0 20px rgba(0, 255, 204, 0.6);
        }

        .next-btn:active {
            transform: scale(0.96);
            background: var(--accent-color);
        }

        /* RESULTS SECTION */
        #results-section {
            display: none;
            padding-bottom: 50px;
            animation: fadeIn 1s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .result-header {
            font-size: 2rem;
            margin-bottom: 10px;
            color: #fff;
        }

        .ego-zone {
            font-size: 1.1rem;
            color: #bbb;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--secondary-color);
        }

        .chart-wrapper {
            position: relative;
            height: 50vh; 
            width: 100%;
            margin-bottom: 30px;
        }

        .pattern-break-container {
            text-align: left;
            background: #0f0f0f;
            border: 1px solid var(--secondary-color);
            padding: 25px;
            margin-top: 20px;
            border-radius: 8px;
        }

        .pb-title {
            color: var(--accent-color);
            font-size: 1.2rem;
            margin-bottom: 20px;
            text-transform: uppercase;
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
        }

        .pb-item {
            margin-bottom: 25px;
        }

        .pb-item h3 {
            margin: 0 0 8px 0;
            font-size: 1.1rem;
            color: #fff;
        }

        .pb-item p {
            margin: 0;
            font-size: 0.95rem;
            color: #aaa;
            line-height: 1.4;
        }

        .restart-btn {
            margin-top: 30px;
            background: transparent;
            border: 1px solid #555;
            color: #888;
            padding: 12px 30px;
            cursor: pointer;
            font-family: inherit;
            text-transform: uppercase;
            transition: 0.2s;
        }
        
        .restart-btn:hover {
            color: #fff;
            border-color: #fff;
        }

    </style>
</head>
<body>

    <!-- Landing Page -->
    <div id="landing-page">
        <button class="init-btn" onclick="startApp()">Find Ego</button>
    </div>

    <div class="container">
        <!-- Quiz Section -->
        <div id="quiz-section">
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
            
            <div class="question-text" id="question-text">
                Loading...
            </div>

            <!-- Slider -->
            <div class="slider-wrapper">
                <div class="slider-label left">Does not<br>describe me</div>
                
                <div class="range-container">
                    <div class="ticks-overlay">
                        <div class="tick"></div>
                        <div class="tick"></div>
                        <div class="tick"></div>
                        <div class="tick"></div>
                        <div class="tick"></div>
                    </div>
                    <input type="range" min="0" max="100" value="50" step="25" id="response-slider">
                </div>

                <div class="slider-label right">Describes<br>me</div>
            </div>

            <button class="next-btn" onclick="nextQuestion()">Next</button>
        </div>

        <!-- Results Section -->
        <div id="results-section">
            <div class="result-header">SCAN COMPLETE</div>
            <div class="ego-zone" id="ego-zone-display">Calculating Density...</div>

            <div class="chart-wrapper">
                <canvas id="radarChart"></canvas>
            </div>

            <div class="pattern-break-container" id="pattern-breaks">
                <div class="pb-title">Recommended Pattern Breaks</div>
            </div>

            <button class="restart-btn" onclick="location.reload()">Reset System</button>
        </div>
    </div>

    <script>
        // --- DATASET ---
        const questions = [
            // EMPEROR
            { type: 'Emperor', text: "When I am contradicted, I feel a sudden rush of heat in my face or chest." },
            { type: 'Emperor', text: "I secretly believe that most people are incompetent compared to me." },
            { type: 'Emperor', text: "I have a very hard time letting an argument go until I have proven my point." },
            { type: 'Emperor', text: "It bothers me deeply when someone else takes charge of a situation I could handle better." },
            { type: 'Emperor', text: "I feel a loss of respect for people who display weakness or indecision." },
            // MARTYR
            { type: 'Martyr', text: "I frequently feel that I give more to others than I ever receive in return." },
            { type: 'Martyr', text: "When I am upset, I feel a heavy, sinking sensation in my chest or stomach." },
            { type: 'Martyr', text: "Bad luck seems to find me more often than it finds other people." },
            { type: 'Martyr', text: "I replay past hurts in my mind, wondering why people treated me that way." },
            { type: 'Martyr', text: "It annoys me when people don't acknowledge how difficult my situation is." },
            // GURU
            { type: 'Guru', text: "I often feel a sense of pity for people who are 'unconscious' or asleep to the truth." },
            { type: 'Guru', text: "I feel a detached, floaty sensation when others are engaging in gossip or drama." },
            { type: 'Guru', text: "I believe my spiritual or intellectual insights make me different from the average person." },
            { type: 'Guru', text: "I get frustrated when I see people obsessing over shallow, material things." },
            { type: 'Guru', text: "I sometimes use spiritual concepts to avoid dealing with messy human emotions." },
            // SHADOW
            { type: 'Shadow', text: "In group settings, I physically shrink or hunch to take up less space." },
            { type: 'Shadow', text: "I immediately assume I have done something wrong if someone looks at me strangely." },
            { type: 'Shadow', text: "I deflect compliments because I secretly feel I don't deserve them." },
            { type: 'Shadow', text: "I am terrified of being exposed as a fraud or being humiliated in public." },
            { type: 'Shadow', text: "I avoid voicing my opinion because I don't want to sound stupid." },
            // SAVIOR
            { type: 'Savior', text: "I feel a magnetic physical pull to step in when I see someone struggling." },
            { type: 'Savior', text: "I feel resentful when people I have helped don't follow my advice." },
            { type: 'Savior', text: "I worry that if I stop helping, everything around me will fall apart." },
            { type: 'Savior', text: "I derive most of my self-worth from being the person others rely on." },
            { type: 'Savior', text: "It is very hard for me to watch someone fail, even if it's their own lesson to learn." },
            // PHANTOM
            { type: 'Phantom', text: "I feel my throat tighten or my voice disappear when I need to say 'no'." },
            { type: 'Phantom', text: "I will agree with things I don't believe just to keep the peace." },
            { type: 'Phantom', text: "I often 'check out' or dissociate during conflict." },
            { type: 'Phantom', text: "I prefer to ghost people rather than have a difficult conversation." },
            { type: 'Phantom', text: "I believe that if I don't express my needs, I can't be hurt." },
            // HUSTLER
            { type: 'Hustler', text: "I feel a restless vibration in my legs or hands when I am not being productive." },
            { type: 'Hustler', text: "I feel guilty when I take time off to just do nothing." },
            { type: 'Hustler', text: "I constantly compare my achievements to those of my peers." },
            { type: 'Hustler', text: "I believe my value as a human is tied to what I produce or earn." },
            { type: 'Hustler', text: "I lose respect for people who seem lazy or lack ambition." },
            // CONTRARIAN
            { type: 'Contrarian', text: "I feel a prickle of irritation when I realize I am liking something that is popular." },
            { type: 'Contrarian', text: "I often play 'devil's advocate' just to challenge the group consensus." },
            { type: 'Contrarian', text: "I have a deep fear of being seen as 'basic' or ordinary." },
            { type: 'Contrarian', text: "If everyone agrees on something, I automatically assume it must be wrong." },
            { type: 'Contrarian', text: "I pride myself on being the outsider who sees what others miss." },
            // CYNIC
            { type: 'Cynic', text: "I instinctively roll my eyes or feel tension in my brow when hearing hopeful ideas." },
            { type: 'Cynic', text: "I prepare for the worst outcome so I can never be disappointed." },
            { type: 'Cynic', text: "I view optimism as a form of naivety or stupidity." },
            { type: 'Cynic', text: "I use my intellect as a shield to keep people from getting too close." },
            { type: 'Cynic', text: "I trust my doubts more than I trust people's promises." }
        ];

        // --- ANTIDOTES ---
        const antidotes = {
            'Emperor': { title: "Surrender Control", desc: "For the next 24 hours, when someone makes a minor mistake, say nothing. Observe the fire in your chest, but do not act on it." },
            'Martyr': { title: "Rewrite the Script", desc: "Write down your biggest complaint. Now rewrite it removing the words 'me', 'I', 'always', and 'never'." },
            'Guru': { title: "The Ordinary Challenge", desc: "Do something incredibly 'basic' (watch reality TV, eat junk food) and find the joy in it without judging yourself or others." },
            'Shadow': { title: "Take Up Space", desc: "Go to a public place. Stand with your feet wide apart and chest open. Maintain eye contact with a stranger for 3 seconds." },
            'Savior': { title: "Let Them Fail", desc: "Identify one problem you are trying to solve for someone else. Stop. Let the consequences happen. It is their path, not yours." },
            'Phantom': { title: "Voice the Conflict", desc: "Express a preference today that conflicts with someone else (e.g., 'I don't want to eat there'). Do not apologize." },
            'Hustler': { title: "Radical Stillness", desc: "Sit for 15 minutes doing absolutely nothing. No phone, no meditation technique. Just sit. Watch the itch to 'do'." },
            'Contrarian': { title: "Join the Crowd", desc: "Find something popular that you usually mock. Try to understand genuinely why people enjoy it. Join them." },
            'Cynic': { title: "Risk Hope", desc: "Verbalize one sincere hope you have for the future to another person, without adding a disclaimer or a joke." }
        };

        let currentQuestion = 0;
        let scores = {
            'Emperor': 0, 'Martyr': 0, 'Guru': 0, 'Shadow': 0, 
            'Savior': 0, 'Phantom': 0, 'Hustler': 0, 'Contrarian': 0, 'Cynic': 0
        };
        let totalScore = 0; 

        function startApp() {
            questions.sort(() => Math.random() - 0.5);
            document.getElementById('landing-page').style.display = 'none';
            document.getElementById('quiz-section').style.display = 'block';
            loadQuestion();
        }

        function loadQuestion() {
            const q = questions[currentQuestion];
            document.getElementById('question-text').innerText = q.text;
            document.getElementById('response-slider').value = 50;
            
            const pct = (currentQuestion / questions.length) * 100;
            document.getElementById('progress-fill').style.width = pct + "%";
        }

        function nextQuestion() {
            const sliderVal = parseInt(document.getElementById('response-slider').value);
            const type = questions[currentQuestion].type;
            
            scores[type] += sliderVal;
            totalScore += sliderVal;

            currentQuestion++;

            if (currentQuestion < questions.length) {
                loadQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            document.getElementById('quiz-section').style.display = 'none';
            document.getElementById('results-section').style.display = 'block';

            const zoneDisplay = document.getElementById('ego-zone-display');
            let densityText = "";
            if (totalScore < 1500) densityText = "Subtle Ego (High Presence)";
            else if (totalScore < 2500) densityText = "Typical Ego (Standard Structure)";
            else if (totalScore < 3500) densityText = "Strong Ego (High Reactivity)";
            else densityText = "Very Strong Ego (Calcified Identity)";
            
            zoneDisplay.innerHTML = `Ego Density Level: <span style="color:var(--accent-color)">${densityText}</span>`;

            renderChart();
            generatePatternBreaks();
        }

        function renderChart() {
            const ctx = document.getElementById('radarChart').getContext('2d');
            const labels = Object.keys(scores);
            const dataPoints = labels.map(label => Math.round((scores[label] / 500) * 100));
            const chartLabels = labels.map((label, index) => `${label} ${dataPoints[index]}%`);

            // --- FIXED GRADIENT LOGIC ---
            // 1. Get the width and height of the canvas
            const width = ctx.canvas.width;
            const height = ctx.canvas.height;
            
            // 2. Determine the center of the chart
            const centerX = width / 2;
            const centerY = height / 2;

            // 3. Calculate radius based on the SMALLER dimension to ensure rainbow fits inside the box
            // Radar charts are usually square, bounded by the smallest side.
            const gradientRadius = Math.min(width, height) / 2;

            // 4. Create the gradient from center to edge of the square
            const gradient = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, gradientRadius);
            
            // 5. Define Rainbow Stops (Purple -> Red)
            gradient.addColorStop(0, 'rgba(102, 51, 153, 0.7)');  // 0% - Deep Purple
            gradient.addColorStop(0.2, 'rgba(65, 105, 225, 0.7)'); // 20% - Royal Blue
            gradient.addColorStop(0.4, 'rgba(0, 191, 255, 0.7)');  // 40% - Deep Sky Blue
            gradient.addColorStop(0.6, 'rgba(50, 205, 50, 0.7)');  // 60% - Lime Green
            gradient.addColorStop(0.8, 'rgba(255, 215, 0, 0.7)');  // 80% - Gold
            gradient.addColorStop(1, 'rgba(220, 20, 60, 0.8)');    // 100% - Crimson Red

            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: chartLabels,
                    datasets: [{
                        label: 'Ego Footprint',
                        data: dataPoints,
                        backgroundColor: gradient,
                        borderColor: '#fff',
                        borderWidth: 1,
                        pointBackgroundColor: '#fff',
                        pointRadius: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: '#333' },
                            grid: { color: '#333' },
                            pointLabels: {
                                color: '#e0e0e0',
                                font: { family: 'Courier New', size: 11 }
                            },
                            suggestedMin: 0,
                            suggestedMax: 100,
                            ticks: { display: false }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function generatePatternBreaks() {
            const sortedTypes = Object.entries(scores).sort((a, b) => b[1] - a[1]);
            const top3 = sortedTypes.slice(0, 3);
            const container = document.getElementById('pattern-breaks');
            
            top3.forEach(item => {
                const type = item[0];
                const intensity = Math.round((item[1] / 500) * 100);
                const antidote = antidotes[type];
                
                const div = document.createElement('div');
                div.className = 'pb-item';
                div.innerHTML = `
                    <h3>${type} (${intensity}%)</h3>
                    <p><strong>Exercise: ${antidote.title}</strong><br>${antidote.desc}</p>
                `;
                container.appendChild(div);
            });
        }
    </script>
</body>
</html>
